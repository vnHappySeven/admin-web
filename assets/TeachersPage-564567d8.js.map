{"version":3,"file":"TeachersPage-564567d8.js","sources":["../../src/pages/teachers/widgets/TeacherAvatar.vue","../../src/pages/teachers/widgets/TeachersTable.vue","../../src/pages/teachers/composables/useTeachers.ts","../../src/pages/teachers/widgets/EditTeacherForm.vue","../../src/pages/teachers/TeachersPage.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { PropType } from 'vue'\nimport { Teacher } from '../types'\n\nconst avatarColor = (teacherNumber: number) => {\n    const colors = ['primary', '#FFD43A', '#ADFF00', '#262824', 'danger']\n    const index = teacherNumber % colors.length\n    return colors[index]\n}\n\ndefineProps({\n    teacher: {\n        type: Object as PropType<Teacher>,\n        required: true,\n    },\n    size: {\n        type: String,\n        default: 'medium',\n    },\n})\n\nconst isUrl = (avatar: string) => {\n    console.log(avatar, '<= avatar')\n    if (!avatar) return false\n    return avatar.startsWith('http') || avatar.startsWith('blob:')\n}\n</script>\n\n<template>\n    <VaAvatar\n        :size=\"size\"\n        :src=\"isUrl(teacher.coverImageUrl) ? teacher.coverImageUrl : ''\"\n        :fallback-text=\"teacher.number\"\n        :color=\"avatarColor(teacher.number)\"\n    />\n</template>\n","<script setup lang=\"ts\">\nimport { defineVaDataTableColumns, useModal } from 'vuestic-ui'\nimport { Teacher } from '../types'\nimport TeacherAvatar from './TeacherAvatar.vue'\nimport { PropType, computed, toRef } from 'vue'\nimport { Pagination, Sorting } from '../composables/useTeachers'\nimport { useVModel } from '@vueuse/core'\n\nconst columns = defineVaDataTableColumns([\n    { label: 'ID', key: 'id', sortable: true },\n    { label: 'Number', key: 'number', sortable: true },\n    { label: 'Sort Order', key: 'sortOrder', sortable: true },\n    { label: ' ', key: 'actions', align: 'right' },\n])\n\nconst props = defineProps({\n    teachers: {\n        type: Array as PropType<Teacher[]>,\n        required: true,\n    },\n    loading: { type: Boolean, default: false },\n    pagination: { type: Object as PropType<Pagination>, required: true },\n    sortBy: { type: String as PropType<Sorting['sortBy']>, required: true },\n    sortingOrder: { type: String as PropType<Sorting['sortingOrder']>, required: true },\n})\n\nconst emit = defineEmits<{\n    (event: 'editTeacher', teacher: Teacher): void\n    (event: 'deleteTeacher', teacher: Teacher): void\n    (event: 'update:sortBy', sortBy: Sorting['sortBy']): void\n    (event: 'update:sortingOrder', sortingOrder: Sorting['sortingOrder']): void\n}>()\n\nconst teachers = toRef(props, 'teachers')\nconst sortByVModel = useVModel(props, 'sortBy', emit)\nconst sortingOrderVModel = useVModel(props, 'sortingOrder', emit)\n\nconst totalPages = computed(() => Math.ceil(props.pagination.total / props.pagination.perPage))\n\nconst { confirm } = useModal()\n\nconst onTeacherDelete = async (teacher: Teacher) => {\n    const agreed = await confirm({\n        title: 'Delete teacher',\n        message: `Are you sure you want to delete ${teacher.number}?`,\n        okText: 'Delete',\n        cancelText: 'Cancel',\n        size: 'small',\n        maxWidth: '380px',\n    })\n\n    if (agreed) {\n        emit('deleteTeacher', teacher)\n    }\n}\n</script>\n\n<template>\n    <VaDataTable\n        v-model:sort-by=\"sortByVModel\"\n        v-model:sorting-order=\"sortingOrderVModel\"\n        :columns=\"columns\"\n        :items=\"teachers\"\n        :loading=\"$props.loading\"\n    >\n        <template #cell(id)=\"{ rowData }\">\n            <div class=\"font-semibold\">\n                {{ rowData.id }}\n            </div>\n        </template>\n\n        <template #cell(number)=\"{ rowData }\">\n            <div class=\"flex items-center gap-2 max-w-[230px] ellipsis\">\n                <TeacherAvatar :teacher=\"rowData as Teacher\" size=\"small\" />\n                {{ rowData.number }}\n            </div>\n        </template>\n\n        <template #cell(sortOrder)=\"{ rowData }\">\n            <div class=\"text-center font-mono\">\n                {{ rowData.sortOrder }}\n            </div>\n        </template>\n\n        <template #cell(actions)=\"{ rowData }\">\n            <div class=\"flex gap-2 justify-end\">\n                <VaButton\n                    preset=\"primary\"\n                    size=\"small\"\n                    icon=\"mso-edit\"\n                    aria-label=\"Edit teacher\"\n                    @click=\"$emit('editTeacher', rowData as Teacher)\"\n                />\n                <VaButton\n                    preset=\"primary\"\n                    size=\"small\"\n                    icon=\"mso-delete\"\n                    color=\"danger\"\n                    aria-label=\"Delete teacher\"\n                    @click=\"onTeacherDelete(rowData as Teacher)\"\n                />\n            </div>\n        </template>\n    </VaDataTable>\n\n    <div class=\"flex flex-col-reverse md:flex-row gap-2 justify-between items-center py-2\">\n        <div>\n            <b>{{ $props.pagination.total }} results.</b>\n            Results per page\n            <VaSelect v-model=\"$props.pagination.perPage\" class=\"!w-20\" :options=\"[10, 50, 100]\" />\n        </div>\n\n        <div v-if=\"totalPages > 1\" class=\"flex\">\n            <VaButton\n                preset=\"secondary\"\n                icon=\"va-arrow-left\"\n                aria-label=\"Previous page\"\n                :disabled=\"$props.pagination.page === 1\"\n                @click=\"$props.pagination.page--\"\n            />\n            <VaButton\n                class=\"mr-2\"\n                preset=\"secondary\"\n                icon=\"va-arrow-right\"\n                aria-label=\"Next page\"\n                :disabled=\"$props.pagination.page === totalPages\"\n                @click=\"$props.pagination.page++\"\n            />\n            <VaPagination\n                v-model=\"$props.pagination.page\"\n                buttons-preset=\"secondary\"\n                :pages=\"totalPages\"\n                :visible-pages=\"5\"\n                :boundary-links=\"false\"\n                :direction-links=\"false\"\n            />\n        </div>\n    </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.va-data-table {\n    ::v-deep(.va-data-table__table-tr) {\n        border-bottom: 1px solid var(--va-background-border);\n    }\n}\n</style>\n","import { Ref, ref, watch } from 'vue'\nimport { Teacher, CreateTeacherRequest, UpdateTeacherRequest } from '../types'\nimport { watchIgnorable } from '@vueuse/core'\nimport api from '../../../services/api'\n\n// 類型定義移到這裡，不再依賴 data 層\nexport type Pagination = {\n    page: number\n    perPage: number\n    total: number\n}\n\nexport type Sorting = {\n    sortBy: keyof Teacher | undefined\n    sortingOrder: 'asc' | 'desc' | null\n}\n\nexport type Filters = {\n    isActive: boolean\n    search: string\n}\n\nconst makePaginationRef = () => ref<Pagination>({ page: 1, perPage: 10, total: 0 })\nconst makeSortingRef = () => ref<Sorting>({ sortBy: 'name', sortingOrder: null })\nconst makeFiltersRef = () => ref<Partial<Filters>>({ isActive: true, search: '' })\n\nexport const useTeachers = (options?: {\n    pagination?: Ref<Pagination>\n    sorting?: Ref<Sorting>\n    filters?: Ref<Partial<Filters>>\n}) => {\n    const isLoading = ref(false)\n    const teachers = ref<Teacher[]>([])\n\n    const { filters = makeFiltersRef(), sorting = makeSortingRef(), pagination = makePaginationRef() } = options || {}\n\n    const fetch = async () => {\n        isLoading.value = true\n        const params = {\n            isActive: filters.value.isActive,\n            offset: pagination.value.page * pagination.value.perPage - pagination.value.perPage,\n            limit: pagination.value.perPage,\n        }\n        const { data } = await api.axiosInstance.get('/plan/tutor/teacher', { params })\n        teachers.value = data.data\n        console.log(data, 'data')\n        ignoreUpdates(() => {\n            pagination.value = {\n                page: pagination.value.page,\n                perPage: pagination.value.perPage,\n                total: data.total || data.data.length,\n            }\n        })\n\n        isLoading.value = false\n    }\n\n    const { ignoreUpdates } = watchIgnorable([pagination, sorting], fetch, { deep: true })\n\n    watch(\n        filters,\n        () => {\n            // Reset pagination to first page when filters changed\n            pagination.value.page = 1\n            fetch()\n        },\n        { deep: true },\n    )\n\n    fetch()\n\n    return {\n        isLoading,\n\n        filters,\n        sorting,\n        pagination,\n\n        teachers,\n\n        fetch,\n\n        async add(teacher: CreateTeacherRequest) {\n            isLoading.value = true\n            try {\n                await api.axiosInstance.post('/plan/tutor/teacher', teacher)\n                await fetch()\n            } catch (error) {\n                console.error('Error adding teacher:', error)\n                throw error\n            } finally {\n                isLoading.value = false\n            }\n        },\n\n        async update(teacher: UpdateTeacherRequest) {\n            isLoading.value = true\n            const { id, ...teacherData } = teacher\n            await api.axiosInstance.patch(`/plan/tutor/teacher/${id}`, teacherData)\n            await fetch()\n            isLoading.value = false\n        },\n\n        async remove(teacher: Teacher) {\n            isLoading.value = true\n            await api.axiosInstance.delete(`/plan/tutor/teacher/${teacher.id}`)\n            await fetch()\n            isLoading.value = false\n        },\n\n        async uploadImages(images: File[]): Promise<string[]> {\n            try {\n                const formData = new FormData()\n                images.forEach((image) => {\n                    formData.append('images', image)\n                })\n                const response = await api.axiosInstance.post('/plan/tutor/teacher/images/upload', formData, {\n                    headers: {\n                        'Content-Type': 'multipart/form-data',\n                    },\n                })\n                return response.data.data.imageNames\n            } catch (error) {\n                console.error('Error uploading images:', error)\n                throw error\n            }\n        },\n    }\n}\n","<script setup lang=\"ts\">\nimport { PropType, computed, ref, watch } from 'vue'\nimport { useForm, useToast } from 'vuestic-ui'\nimport { Teacher, CreateTeacherRequest, UpdateTeacherRequest } from '../types'\nimport TeacherAvatar from './TeacherAvatar.vue'\nimport { validators } from '../../../services/utils'\nimport { useTeachers } from '../composables/useTeachers'\nconst { uploadImages } = useTeachers()\nconst props = defineProps({\n    teacher: {\n        type: Object as PropType<Teacher | null>,\n        default: null,\n    },\n    saveButtonLabel: {\n        type: String,\n        default: 'Save',\n    },\n})\n\nconst defaultNewTeacher: Teacher = {\n    id: -1,\n    number: 0,\n    coverImage: '',\n    images: [],\n    height: 0,\n    weight: 0,\n    birthYear: 0,\n    sortOrder: 0,\n    isActive: true,\n    createdAt: '',\n    updatedAt: '',\n    deletedAt: null,\n    coverImageUrl: '',\n    imageUrls: [],\n}\n\nconst newTeacher = ref<Teacher>({ ...defaultNewTeacher })\n\nconst isFormHasUnsavedChanges = computed(() => {\n    return Object.keys(newTeacher.value).some((key) => {\n        if (key === 'avatar' || key === 'images') {\n            return false\n        }\n\n        return newTeacher.value[key as keyof Teacher] !== (props.teacher ?? defaultNewTeacher)?.[key as keyof Teacher]\n    })\n})\n\ndefineExpose({\n    isFormHasUnsavedChanges,\n})\n\nwatch(\n    () => props.teacher,\n    () => {\n        if (!props.teacher) {\n            return\n        }\n\n        newTeacher.value = {\n            ...props.teacher,\n        }\n    },\n    { immediate: true },\n)\nconst avatar = ref<File>()\nconst originalImages = ref<File[]>([])\n\nconst makeAvatarBlobUrl = (avatar: File) => {\n    return URL.createObjectURL(avatar)\n}\n\nconst makeImageBlobUrl = (image: File) => {\n    return URL.createObjectURL(image)\n}\n\nconst removeExistingImage = (index: number) => {\n    if (newTeacher.value.imageUrls) {\n        newTeacher.value.imageUrls.splice(index, 1)\n    }\n    if (newTeacher.value.images) {\n        newTeacher.value.images.splice(index, 1)\n    }\n}\n\nwatch(avatar, (newAvatar) => {\n    newTeacher.value.coverImageUrl = newAvatar ? makeAvatarBlobUrl(newAvatar) : ''\n})\n\nconst form = useForm('add-teacher-form')\n\nconst emit = defineEmits<{\n    close: []\n    save: [teacher: CreateTeacherRequest | UpdateTeacherRequest]\n}>()\n\nconst onSave = async () => {\n    // 首先驗證表單，如果驗證失敗就直接返回\n    if (!form.validate()) {\n        return\n    }\n\n    if (!avatar.value && !newTeacher.value.coverImage) {\n        // 如果沒有上傳封面圖片，且無現有封面圖片，則不可送出\n        useToast().init({ message: '請上傳大頭照', position: 'top-right', color: 'danger' })\n        return\n    }\n    if (originalImages.value.length === 0 && newTeacher.value.images.length === 0) {\n        // 如果沒有上傳相片集，且無現有相片集，則不可送出\n        useToast().init({ message: '請至少上傳一張相片', position: 'top-right', color: 'danger' })\n        return\n    }\n\n    if (avatar.value) {\n        await uploadImages([avatar.value]).then((response: string[]) => {\n            newTeacher.value.coverImage = response[0]\n        })\n    }\n    if (originalImages.value.length > 0) {\n        await uploadImages(originalImages.value).then((response: string[]) => {\n            // 增量式新增圖片，不覆蓋既有的圖片\n            if (!newTeacher.value.images) {\n                newTeacher.value.images = []\n            }\n            newTeacher.value.images.push(...response)\n        })\n    }\n\n    // 判斷是新增還是編輯\n    if (props.teacher) {\n        // 編輯模式 - 使用 UpdateTeacherRequest\n        const teacherData: UpdateTeacherRequest = {\n            id: props.teacher.id,\n            number: newTeacher.value.number ? Number(newTeacher.value.number) : 0,\n            coverImage: newTeacher.value.coverImage,\n            images: newTeacher.value.images,\n            height: newTeacher.value.height ? Number(newTeacher.value.height) : 0,\n            weight: newTeacher.value.weight ? Number(newTeacher.value.weight) : 0,\n            birthYear: newTeacher.value.birthYear ? Number(newTeacher.value.birthYear) : 0,\n            sortOrder: Number(newTeacher.value.sortOrder) || 0,\n            isActive: newTeacher.value.isActive,\n        }\n\n        emit('save', teacherData)\n    } else {\n        // 新增模式 - 使用 CreateTeacherRequest\n        const teacherData: CreateTeacherRequest = {\n            number: newTeacher.value.number ? Number(newTeacher.value.number) : 0,\n            coverImage: newTeacher.value.coverImage,\n            images: newTeacher.value.images,\n            height: newTeacher.value.height ? Number(newTeacher.value.height) : 0,\n            weight: newTeacher.value.weight ? Number(newTeacher.value.weight) : 0,\n            birthYear: newTeacher.value.birthYear ? Number(newTeacher.value.birthYear) : 0,\n            sortOrder: Number(newTeacher.value.sortOrder) || 0,\n            isActive: newTeacher.value.isActive,\n        }\n\n        emit('save', teacherData)\n    }\n}\n</script>\n\n<template>\n    <VaForm\n        v-slot=\"{ isValid }\"\n        ref=\"add-teacher-form\"\n        class=\"flex-col justify-start items-start gap-4 inline-flex w-full\"\n    >\n        <VaFileUpload\n            v-model=\"avatar\"\n            type=\"single\"\n            hide-file-list\n            class=\"self-stretch justify-start items-center gap-4 inline-flex\"\n        >\n            <TeacherAvatar :teacher=\"newTeacher\" size=\"large\" />\n            <VaButton preset=\"primary\" size=\"small\">Add image</VaButton>\n            <VaButton\n                v-if=\"avatar\"\n                preset=\"primary\"\n                color=\"danger\"\n                size=\"small\"\n                icon=\"delete\"\n                class=\"z-10\"\n                @click.stop=\"avatar = undefined\"\n            />\n        </VaFileUpload>\n        <div class=\"self-stretch flex-col justify-start items-start gap-4 flex\">\n            <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n                <VaInput\n                    v-model=\"newTeacher.number\"\n                    label=\"編號\"\n                    class=\"w-full sm:w-1/2\"\n                    :rules=\"[validators.required]\"\n                    name=\"number\"\n                    type=\"number\"\n                />\n            </div>\n            <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n                <VaInput v-model=\"newTeacher.height\" label=\"身高 (cm)\" placeholder=\"身高\" class=\"w-full\" />\n                <VaInput v-model=\"newTeacher.weight\" label=\"體重 (kg)\" placeholder=\"體重\" class=\"w-full\" />\n            </div>\n            <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n                <VaInput v-model=\"newTeacher.birthYear\" label=\"出生年\" placeholder=\"出生年\" class=\"w-full\" />\n            </div>\n\n            <!-- 複數相片上傳 -->\n            <div class=\"w-full\">\n                <label class=\"va-input-label\">相片集</label>\n                <VaFileUpload\n                    v-model=\"originalImages\"\n                    type=\"gallery\"\n                    file-types=\"image/*\"\n                    class=\"w-full\"\n                    hide-file-list\n                >\n                    <VaButton preset=\"primary\" size=\"small\">上傳相片</VaButton>\n                </VaFileUpload>\n\n                <!-- 顯示縮圖 -->\n                <div\n                    v-if=\"newTeacher.imageUrls?.length > 0 || originalImages.length > 0\"\n                    class=\"flex flex-wrap gap-2 mt-4\"\n                >\n                    <!-- 顯示舊有照片縮圖 -->\n                    <div\n                        v-for=\"(imageUrl, index) in newTeacher.imageUrls\"\n                        :key=\"`existing-${index}`\"\n                        class=\"relative w-20 h-20 border border-gray-300 rounded overflow-hidden\"\n                    >\n                        <img :src=\"imageUrl\" :alt=\"`Existing Photo ${index + 1}`\" class=\"w-full h-full object-cover\" />\n                        <VaButton\n                            preset=\"primary\"\n                            color=\"danger\"\n                            size=\"small\"\n                            icon=\"delete\"\n                            class=\"absolute top-1 right-1 w-6 h-6 min-w-0 p-0\"\n                            @click=\"removeExistingImage(index)\"\n                        />\n                    </div>\n\n                    <!-- 顯示新上傳照片縮圖 -->\n                    <div\n                        v-for=\"(image, index) in originalImages\"\n                        :key=\"`new-${index}`\"\n                        class=\"relative w-20 h-20 border border-gray-300 rounded overflow-hidden\"\n                    >\n                        <img\n                            :src=\"makeImageBlobUrl(image)\"\n                            :alt=\"`New Photo ${index + 1}`\"\n                            class=\"w-full h-full object-cover\"\n                        />\n                        <VaButton\n                            preset=\"primary\"\n                            color=\"danger\"\n                            size=\"small\"\n                            icon=\"delete\"\n                            class=\"absolute top-1 right-1 w-6 h-6 min-w-0 p-0\"\n                            @click=\"originalImages.splice(index, 1)\"\n                        />\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"flex gap-4 w-full\">\n                <div class=\"flex items-center w-1/2 mt-4\">\n                    <VaCheckbox v-model=\"newTeacher.isActive\" label=\"Active\" class=\"w-full\" name=\"active\" />\n                </div>\n            </div>\n\n            <div class=\"flex gap-4 flex-col sm:flex-row w-full\">\n                <VaInput\n                    v-model=\"newTeacher.sortOrder\"\n                    label=\"Sort Order\"\n                    class=\"w-full sm:w-1/2\"\n                    :rules=\"[validators.required]\"\n                    name=\"sortOrder\"\n                    type=\"number\"\n                />\n            </div>\n            <div class=\"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center\">\n                <VaButton preset=\"secondary\" color=\"secondary\" @click=\"$emit('close')\">Cancel</VaButton>\n                <VaButton :disabled=\"!isValid\" @click=\"onSave\">{{ saveButtonLabel }}</VaButton>\n            </div>\n        </div>\n    </VaForm>\n</template>\n","<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport TeachersTable from './widgets/TeachersTable.vue'\nimport EditTeacherForm from './widgets/EditTeacherForm.vue'\nimport { Teacher, CreateTeacherRequest, UpdateTeacherRequest } from './types'\nimport { useTeachers } from './composables/useTeachers'\nimport { useModal, useToast } from 'vuestic-ui'\n\nconst doShowEditTeacherModal = ref(false)\n\nconst { teachers, isLoading, filters, sorting, pagination, ...teachersApi } = useTeachers()\n\nconst teacherToEdit = ref<Teacher | null>(null)\n\nconst showEditTeacherModal = (teacher: Teacher) => {\n    teacherToEdit.value = teacher\n    doShowEditTeacherModal.value = true\n}\n\nconst showAddTeacherModal = () => {\n    teacherToEdit.value = null\n    doShowEditTeacherModal.value = true\n}\n\nconst { init: notify } = useToast()\n\nconst onTeacherSaved = async (teacher: CreateTeacherRequest | UpdateTeacherRequest) => {\n    try {\n        if ('id' in teacher) {\n            // 編輯模式 - teacher 包含 id 屬性\n            await teachersApi.update(teacher as UpdateTeacherRequest)\n            notify({\n                message: `${teacher.number} has been updated`,\n                color: 'success',\n            })\n        } else {\n            // 新增模式 - teacher 沒有 id 屬性\n            await teachersApi.add(teacher as CreateTeacherRequest)\n            notify({\n                message: `${teacher.number} has been created`,\n                color: 'success',\n            })\n        }\n    } catch (error) {\n        notify({\n            message: 'Operation failed. Please try again.',\n            color: 'danger',\n        })\n    }\n}\n\nconst onTeacherDelete = async (teacher: Teacher) => {\n    await teachersApi.remove(teacher)\n    notify({\n        message: `${teacher.number} has been deleted`,\n        color: 'success',\n    })\n}\n\nconst editFormRef = ref()\n\nconst { confirm } = useModal()\n\nconst beforeEditFormModalClose = async (hide: () => unknown) => {\n    if (editFormRef.value.isFormHasUnsavedChanges) {\n        const agreed = await confirm({\n            maxWidth: '380px',\n            message: 'Form has unsaved changes. Are you sure you want to close it?',\n            size: 'small',\n        })\n        if (agreed) {\n            hide()\n        }\n    } else {\n        hide()\n    }\n}\n</script>\n\n<template>\n    <h1 class=\"page-title\">老師</h1>\n\n    <VaCard>\n        <VaCardContent>\n            <div class=\"flex flex-col md:flex-row gap-2 mb-2 justify-between\">\n                <div class=\"flex flex-col md:flex-row gap-2 justify-start\">\n                    <VaButtonToggle\n                        v-model=\"filters.isActive\"\n                        color=\"background-element\"\n                        border-color=\"background-element\"\n                        :options=\"[\n                            { label: 'Active', value: true },\n                            { label: 'Inactive', value: false },\n                        ]\"\n                    />\n                    <VaInput v-model=\"filters.search\" placeholder=\"Search\">\n                        <template #prependInner>\n                            <VaIcon name=\"search\" color=\"secondary\" size=\"small\" />\n                        </template>\n                    </VaInput>\n                </div>\n                <VaButton @click=\"showAddTeacherModal\">Add Teacher</VaButton>\n            </div>\n\n            <TeachersTable\n                v-model:sort-by=\"sorting.sortBy\"\n                v-model:sorting-order=\"sorting.sortingOrder\"\n                :teachers=\"teachers\"\n                :loading=\"isLoading\"\n                :pagination=\"pagination\"\n                @editTeacher=\"showEditTeacherModal\"\n                @deleteTeacher=\"onTeacherDelete\"\n            />\n        </VaCardContent>\n    </VaCard>\n\n    <VaModal\n        v-slot=\"{ cancel, ok }\"\n        v-model=\"doShowEditTeacherModal\"\n        size=\"small\"\n        mobile-fullscreen\n        close-button\n        hide-default-actions\n        :before-cancel=\"beforeEditFormModalClose\"\n    >\n        <h1 class=\"va-h5\">{{ teacherToEdit ? 'Edit teacher' : 'Add teacher' }}</h1>\n        <EditTeacherForm\n            ref=\"editFormRef\"\n            :teacher=\"teacherToEdit\"\n            :save-button-label=\"teacherToEdit ? 'Save' : 'Add'\"\n            @close=\"cancel\"\n            @save=\"\n                (teacher: CreateTeacherRequest | UpdateTeacherRequest) => {\n                    onTeacherSaved(teacher)\n                    ok()\n                }\n            \"\n        />\n    </VaModal>\n</template>\n"],"names":["avatarColor","teacherNumber","colors","index","isUrl","avatar","columns","defineVaDataTableColumns","props","__props","emit","__emit","teachers","toRef","sortByVModel","useVModel","sortingOrderVModel","totalPages","computed","confirm","useModal","onTeacherDelete","teacher","makePaginationRef","ref","makeSortingRef","makeFiltersRef","useTeachers","options","isLoading","filters","sorting","pagination","fetch","params","data","api","ignoreUpdates","watchIgnorable","watch","error","id","teacherData","images","formData","image","uploadImages","defaultNewTeacher","newTeacher","isFormHasUnsavedChanges","key","_a","__expose","originalImages","makeAvatarBlobUrl","makeImageBlobUrl","removeExistingImage","newAvatar","form","useForm","onSave","useToast","response","doShowEditTeacherModal","teachersApi","teacherToEdit","showEditTeacherModal","showAddTeacherModal","notify","onTeacherSaved","editFormRef","beforeEditFormModalClose","hide"],"mappings":"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"}