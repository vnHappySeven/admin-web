import{s as d}from"./utils-b2fc192b.js";import{a as v,p as y}from"./useProjects-2a190262.js";import{r as l,C as U,u as p}from"./index-d92a7827.js";import{w as h}from"./index-721b2354.js";const o=v,j=a=>y.filter(e=>e.team.includes(Number(a))).map(e=>({...e,project_owner:o.find(r=>r.id===e.project_owner),team:e.team.map(r=>o.find(i=>i.id===r)),status:e.status})),w=(a,e)=>e==="projects"?a.projects.map(r=>r.project_name).join(", "):a[e],P=async a=>{await d(1e3);const{isActive:e,search:r,sortBy:i,sortingOrder:c}=a;let t=o;t=t.filter(s=>s.active===e),r&&(t=t.filter(s=>s.fullname.toLowerCase().includes(r.toLowerCase()))),t=t.map(s=>({...s,projects:j(s.id)})),i&&c&&(t=t.sort((s,f)=>{const m=w(s,i),g=w(f,i);return m>g?c==="asc"?1:-1:m<g?c==="asc"?-1:1:0}));const{page:n=1,perPage:u=10}=a||{};return{data:t.slice((n-1)*u,n*u),pagination:{page:n,perPage:u,total:t.length}}},x=async a=>{await d(1e3),o.unshift(a)},I=async a=>{await d(1e3);const e=o.findIndex(r=>r.id===a.id);o[e]=a},b=async a=>{await d(1e3),o.splice(o.findIndex(e=>e.id===a.id),1)},k=()=>l({page:1,perPage:10,total:0}),C=()=>l({sortBy:"fullname",sortingOrder:null}),L=()=>l({isActive:!0,search:""}),O=a=>{const e=l(!1),r=l([]),{filters:i=L(),sorting:c=C(),pagination:t=k()}=a||{},n=async()=>{e.value=!0;const{data:s,pagination:f}=await P({...p(i),...p(c),...p(t)});r.value=s,u(()=>{t.value=f}),e.value=!1},{ignoreUpdates:u}=h([t,c],n,{deep:!0});return U(i,()=>{t.value.page=1,n()},{deep:!0}),n(),{isLoading:e,filters:i,sorting:c,pagination:t,users:r,fetch:n,async add(s){e.value=!0,await x(s),await n(),e.value=!1},async update(s){e.value=!0,await I(s),await n(),e.value=!1},async remove(s){e.value=!0,await b(s),await n(),e.value=!1}}};export{O as u};
//# sourceMappingURL=useUsers-656437b1.js.map
