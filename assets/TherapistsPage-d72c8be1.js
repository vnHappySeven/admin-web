import{d as Z,w as ee}from"./index-49ce9307.js";import{u as J}from"./useModal-d2a2e728.js";import{d as R,f as b,a as N,g as L,X as te,e as K,c as O,h as a,w,b as d,t as $,i as C,u as m,Y as q,H as z,F as D,_ as ae,r as k,C as P,R as se,x as le}from"./index-153146de.js";import{u as W}from"./index-8601aa1b.js";import{u as oe}from"./useForm-5480a1c6.js";import{v as F,s as E}from"./utils-b2fc192b.js";import{a as re}from"./api-48a95b3a.js";import{u as ne}from"./useToast-2d290bdd.js";const Q=R({__name:"TherapistAvatar",props:{therapist:{type:Object,required:!0},size:{type:String,default:"medium"}},setup(n){const r=i=>{const u=["primary","#FFD43A","#ADFF00","#262824","danger"],e=i.charCodeAt(0)%u.length;return u[e]},f=i=>i.startsWith("http")||i.startsWith("blob:");return(i,u)=>{const e=b("VaAvatar");return N(),L(e,{size:n.size,src:f(n.therapist.coverImage)?n.therapist.coverImage:"","fallback-text":n.therapist.coverImage||n.therapist.name[0],color:r(n.therapist.name)},null,8,["size","src","fallback-text","color"])}}}),ie={class:"font-semibold"},pe={class:"flex items-center gap-2 max-w-[230px] ellipsis"},ue={class:"text-center font-mono"},ce={class:"flex gap-2 justify-end"},de={class:"flex flex-col-reverse md:flex-row gap-2 justify-between items-center py-2"},me={key:0,class:"flex"},ve=R({__name:"TherapistsTable",props:{therapists:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Object,required:!0},sortBy:{type:String,required:!0},sortingOrder:{type:String,required:!0}},emits:["edit-therapist","delete-therapist","update:sortBy","update:sortingOrder"],setup(n,{emit:r}){const f=Z([{label:"Number",key:"number",sortable:!0},{label:"Name",key:"name",sortable:!0},{label:"Sort Order",key:"sortOrder",sortable:!0},{label:" ",key:"actions",align:"right"}]),i=n,u=r,e=te(i,"therapists"),v=W(i,"sortBy",u),g=W(i,"sortingOrder",u),o=K(()=>Math.ceil(i.pagination.total/i.pagination.perPage)),{confirm:_}=J(),T=async c=>{await _({title:"Delete therapist",message:`Are you sure you want to delete ${c.name}?`,okText:"Delete",cancelText:"Cancel",size:"small",maxWidth:"380px"})&&u("delete-therapist",c)};return(c,y)=>{const U=b("VaButton"),h=b("VaDataTable"),t=b("VaSelect"),x=b("VaPagination");return N(),O(D,null,[a(h,{"sort-by":m(v),"onUpdate:sortBy":y[0]||(y[0]=l=>q(v)?v.value=l:null),"sorting-order":m(g),"onUpdate:sortingOrder":y[1]||(y[1]=l=>q(g)?g.value=l:null),columns:m(f),items:e.value,loading:c.$props.loading},{"cell(number)":w(({rowData:l})=>[d("div",ie,$(l.number),1)]),"cell(name)":w(({rowData:l})=>[d("div",pe,[a(Q,{therapist:l,size:"small"},null,8,["therapist"]),C(" "+$(l.name),1)])]),"cell(sortOrder)":w(({rowData:l})=>[d("div",ue,$(l.sortOrder),1)]),"cell(actions)":w(({rowData:l})=>[d("div",ce,[a(U,{preset:"primary",size:"small",icon:"mso-edit","aria-label":"Edit therapist",onClick:p=>c.$emit("edit-therapist",l)},null,8,["onClick"]),a(U,{preset:"primary",size:"small",icon:"mso-delete",color:"danger","aria-label":"Delete therapist",onClick:p=>T(l)},null,8,["onClick"])])]),_:1},8,["sort-by","sorting-order","columns","items","loading"]),d("div",de,[d("div",null,[d("b",null,$(c.$props.pagination.total)+" results.",1),C(" Results per page "),a(t,{modelValue:c.$props.pagination.perPage,"onUpdate:modelValue":y[2]||(y[2]=l=>c.$props.pagination.perPage=l),class:"!w-20",options:[10,50,100]},null,8,["modelValue"])]),o.value>1?(N(),O("div",me,[a(U,{preset:"secondary",icon:"va-arrow-left","aria-label":"Previous page",disabled:c.$props.pagination.page===1,onClick:y[3]||(y[3]=l=>c.$props.pagination.page--)},null,8,["disabled"]),a(U,{class:"mr-2",preset:"secondary",icon:"va-arrow-right","aria-label":"Next page",disabled:c.$props.pagination.page===o.value,onClick:y[4]||(y[4]=l=>c.$props.pagination.page++)},null,8,["disabled"]),a(x,{modelValue:c.$props.pagination.page,"onUpdate:modelValue":y[5]||(y[5]=l=>c.$props.pagination.page=l),"buttons-preset":"secondary",pages:o.value,"visible-pages":5,"boundary-links":!1,"direction-links":!1},null,8,["modelValue","pages"])])):z("",!0)])],64)}}});const ge=ae(ve,[["__scopeId","data-v-afb10bef"]]),he={class:"self-stretch flex-col justify-start items-start gap-4 flex"},be={class:"flex gap-4 flex-col sm:flex-row w-full"},fe={class:"flex gap-4 flex-col sm:flex-row w-full"},ye={class:"flex gap-4 flex-col sm:flex-row w-full"},we={class:"flex gap-4 flex-col sm:flex-row w-full"},Ve={class:"w-full"},ke=d("label",{class:"va-input-label"},"相片集",-1),xe={key:0,class:"flex flex-wrap gap-2 mt-4"},_e=["src","alt"],Ne={class:"flex gap-4 w-full"},Te={class:"flex items-center w-1/2 mt-4"},Ue={class:"flex gap-4 flex-col sm:flex-row w-full"},Ce={class:"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center"},$e=R({__name:"EditTherapistForm",props:{therapist:{type:Object,default:null},saveButtonLabel:{type:String,default:"Save"}},emits:["close","save"],setup(n,{expose:r,emit:f}){const i=n,u={id:-1,number:0,name:"",coverImage:"",images:[],height:void 0,weight:void 0,birthYear:void 0,description:"",technicalLevel:"",removal:"",serviceMedal:"",note:"",recommendRank:"",paymentNote:"",sortOrder:0,email:"",username:"",avatar:"",active:!0},e=k({...u}),v=K(()=>Object.keys(e.value).some(h=>{var t;return h==="avatar"||h==="images"?!1:e.value[h]!==((t=i.therapist??u)==null?void 0:t[h])}));r({isFormHasUnsavedChanges:v}),P(()=>i.therapist,()=>{i.therapist&&(e.value={...i.therapist,avatar:i.therapist.avatar||""})},{immediate:!0});const g=k(),o=k([]),_=h=>URL.createObjectURL(h),T=h=>URL.createObjectURL(h);P(g,h=>{e.value.avatar=h?_(h):""});const c=oe("add-therapist-form"),y=f,U=()=>{c.validate()&&y("save",e.value)};return(h,t)=>{const x=b("VaButton"),l=b("VaFileUpload"),p=b("VaInput"),M=b("VaCheckbox"),A=b("VaTextarea"),S=b("VaForm");return N(),L(S,{ref:"add-therapist-form",class:"flex-col justify-start items-start gap-4 inline-flex w-full"},{default:w(({isValid:j})=>[a(l,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),type:"single","hide-file-list":"",class:"self-stretch justify-start items-center gap-4 inline-flex"},{default:w(()=>[a(Q,{therapist:e.value,size:"large"},null,8,["therapist"]),a(x,{preset:"primary",size:"small"},{default:w(()=>[C("Add image")]),_:1}),g.value?(N(),L(x,{key:0,preset:"primary",color:"danger",size:"small",icon:"delete",class:"z-10",onClick:t[0]||(t[0]=se(s=>g.value=void 0,["stop"]))})):z("",!0)]),_:1},8,["modelValue"]),d("div",he,[d("div",be,[a(p,{modelValue:e.value.name,"onUpdate:modelValue":t[2]||(t[2]=s=>e.value.name=s),label:"名稱",class:"w-full sm:w-1/2",rules:[m(F).required],name:"name"},null,8,["modelValue","rules"]),a(p,{modelValue:e.value.number,"onUpdate:modelValue":t[3]||(t[3]=s=>e.value.number=s),label:"號碼",class:"w-full sm:w-1/2",rules:[m(F).required],name:"number",type:"number"},null,8,["modelValue","rules"])]),d("div",fe,[a(p,{modelValue:e.value.height,"onUpdate:modelValue":t[4]||(t[4]=s=>e.value.height=s),label:"身高 (cm)",class:"w-full sm:w-1/2",name:"height",type:"number"},null,8,["modelValue"]),a(p,{modelValue:e.value.weight,"onUpdate:modelValue":t[5]||(t[5]=s=>e.value.weight=s),label:"體重 (kg)",class:"w-full sm:w-1/2",name:"weight",type:"number"},null,8,["modelValue"])]),d("div",ye,[a(p,{modelValue:e.value.birthYear,"onUpdate:modelValue":t[6]||(t[6]=s=>e.value.birthYear=s),label:"出生年份",class:"w-full sm:w-1/2",name:"birthYear",type:"number"},null,8,["modelValue"]),a(p,{modelValue:e.value.technicalLevel,"onUpdate:modelValue":t[7]||(t[7]=s=>e.value.technicalLevel=s),label:"技術級別",class:"w-full sm:w-1/2",name:"technicalLevel"},null,8,["modelValue"])]),d("div",we,[a(p,{modelValue:e.value.serviceMedal,"onUpdate:modelValue":t[8]||(t[8]=s=>e.value.serviceMedal=s),label:"服務獎章",class:"w-full sm:w-1/2",name:"serviceMedal"},null,8,["modelValue"]),a(p,{modelValue:e.value.recommendRank,"onUpdate:modelValue":t[9]||(t[9]=s=>e.value.recommendRank=s),label:"推薦指數",class:"w-full sm:w-1/2",name:"recommendRank"},null,8,["modelValue"])]),d("div",Ve,[ke,a(l,{modelValue:o.value,"onUpdate:modelValue":t[10]||(t[10]=s=>o.value=s),type:"gallery","file-types":"image/*",class:"w-full","hide-file-list":""},{default:w(()=>[a(x,{preset:"primary",size:"small"},{default:w(()=>[C("上傳相片")]),_:1})]),_:1},8,["modelValue"]),o.value.length>0?(N(),O("div",xe,[(N(!0),O(D,null,le(o.value,(s,I)=>(N(),O("div",{key:I,class:"relative w-20 h-20 border border-gray-300 rounded overflow-hidden"},[d("img",{src:T(s),alt:`Photo ${I+1}`,class:"w-full h-full object-cover"},null,8,_e),a(x,{preset:"primary",color:"danger",size:"small",icon:"delete",class:"absolute top-1 right-1 w-6 h-6 min-w-0 p-0",onClick:Y=>o.value.splice(I,1)},null,8,["onClick"])]))),128))])):z("",!0)]),d("div",Ne,[d("div",Te,[a(M,{modelValue:e.value.active,"onUpdate:modelValue":t[11]||(t[11]=s=>e.value.active=s),label:"Active",class:"w-full",name:"active"},null,8,["modelValue"])])]),a(A,{modelValue:e.value.description,"onUpdate:modelValue":t[12]||(t[12]=s=>e.value.description=s),label:"Description",class:"w-full",name:"description"},null,8,["modelValue"]),a(A,{modelValue:e.value.note,"onUpdate:modelValue":t[13]||(t[13]=s=>e.value.note=s),label:"Notes",class:"w-full",name:"note"},null,8,["modelValue"]),a(A,{modelValue:e.value.paymentNote,"onUpdate:modelValue":t[14]||(t[14]=s=>e.value.paymentNote=s),label:"Payment Note",class:"w-full",name:"paymentNote"},null,8,["modelValue"]),d("div",Ue,[a(p,{modelValue:e.value.sortOrder,"onUpdate:modelValue":t[15]||(t[15]=s=>e.value.sortOrder=s),label:"Sort Order",class:"w-full sm:w-1/2",rules:[m(F).required],name:"sortOrder",type:"number"},null,8,["modelValue","rules"]),a(p,{modelValue:e.value.removal,"onUpdate:modelValue":t[16]||(t[16]=s=>e.value.removal=s),label:"Removal Status",class:"w-full sm:w-1/2",name:"removal"},null,8,["modelValue"])]),d("div",Ce,[a(x,{preset:"secondary",color:"secondary",onClick:t[17]||(t[17]=s=>h.$emit("close"))},{default:w(()=>[C("Cancel")]),_:1}),a(x,{disabled:!j,onClick:U},{default:w(()=>[C($(n.saveButtonLabel),1)]),_:2},1032,["disabled"])])])]),_:1},512)}}}),Oe=[{id:0,number:0,name:"節省塔兔",coverImage:"https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/small/No.00%20(0).webp",images:["https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.00%20(0).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.00%20(1).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.00%20(2).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.00%20(3).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.00%20(4).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.00%20(5).webp"],height:156,weight:45,birthYear:1997,description:"平政范曉萱/略英文/自彈自唱/才藝少女/目前正職為西貢Q3某藝術TATTOO店老師，從小家境優渥學習音樂，後因父親沾染賭癮以致家道中落，窮到她們家連衣服都買不起，故其終極願望是能刺滿全身的日本極道全甲刺青，這樣就能出門不用穿衣服非常節省，如果你也是NBA 塞爾提克隊主力雙探花之0號JAYSON TATUM的粉絲，也不妨試試我們家越南節省塔兔老師的龍筋功力！",technicalLevel:"👑技術總監",removal:"🌻已升級",serviceMedal:"🏅已頒發",note:"",paymentNote:"",sortOrder:1,recommendRank:"❤️❤️❤️❤️❤️❤️❤️❤️❤️🤍9/10",active:!0},{id:1,number:1,name:"豪爽一姐",coverImage:"https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/small/No.01%20(0).webp",images:["https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.01%20(0).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.01%20(1).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.01%20(2).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.01%20(3).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.01%20(4).webp"],height:165,weight:51,birthYear:1994,description:"開背王者/不知火燈-可全自動/酸痛救星，豪爽北姑，喜歡直球對決，有背就開，球來就打，據說沒有他開不了的背，想體驗一姐好爽的貴賓千萬一定要試看看。",technicalLevel:"👑首席技術總監",removal:"🌻自求多福",serviceMedal:"🏅已頒發",note:"",paymentNote:"",sortOrder:2,recommendRank:"❤️❤️❤️❤️❤️❤️🤍🤍🤍🤍 6/10",active:!0},{id:2,number:2,name:"幸運女神",coverImage:"https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/small/No.02%20(0).webp",images:["https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.02%20(0).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.02%20(1).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.02%20(2).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.02%20(3).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.02%20(4).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.02%20(5).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.02%20(6).webp"],height:160,weight:48,birthYear:1994,description:"改裝燈-可全自動/可中英韓文/熱愛健身/熱情大方/評價:擔任本團隊首席技術總監，號稱沒有推不開的筋絡的她，上背部繡有來自清邁的性感招福圖騰，需要轉運的您不容錯過～",technicalLevel:"👑首席技術總監",removal:"🌻曾經升級，但被印度貴賓內痔掉出驚嚇，目前尚有陰影，暫不提供，希望有貴賓能夠輔導她再次走出陰霾😹",serviceMedal:"🏅已頒發",note:"技術總監首席指定費+50萬越盾起(手法完全不同，純按的貴賓請路過)",paymentNote:"若選中 2. 幸運女神，尾款需加價 1,000K",sortOrder:3,recommendRank:"❤️❤️❤️❤️❤️❤️❤️❤️❤️💛9.5/10",active:!0},{id:3,number:3,name:"妖熟都市",coverImage:"https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/small/No.03%20(0).webp",images:["https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.03%20(0).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.03%20(1).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.03%20(2).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.03%20(3).webp","https://storage.googleapis.com/public-access-bucket-vnhappy7-dev/therapist/No.03%20(4).webp"],height:158,weight:51,birthYear:1992,description:"不知火燈-全自動/習慣在客人住處各個角落留下愛液氣味記號，家有女主人者建議路過，愛喝臭酸豆漿，歡迎老闆們大膽施捨。2024年第三季好評王強力競爭者。",technicalLevel:"體驗級",removal:"🌻已升級",serviceMedal:"🏅已頒發",note:"",paymentNote:"",sortOrder:4,recommendRank:"❤️❤️❤️❤️❤️❤️❤️💛🤍🤍7.5/10",active:!0}],B=Oe,H=(n,r)=>r==="projects"?n.projects.map(f=>f.project_name).join(", "):n[r],Be=async n=>{try{await re.getTherapists(n)}catch(o){console.error("Error fetching therapists:",o)}const{isActive:r,search:f,sortBy:i,sortingOrder:u}=n;let e=[...B];e=e.filter(o=>o.active===r),f&&(e=e.filter(o=>o.name.toLowerCase().includes(f.toLowerCase()))),e=e.map(o=>({...o,projects:[]})),i&&u&&(e=e.sort((o,_)=>{const T=H(o,i),c=H(_,i);return T>c?u==="asc"?1:-1:T<c?u==="asc"?-1:1:0}));const{page:v=1,perPage:g=10}=n||{};return{data:e.slice((v-1)*g,v*g),pagination:{page:v,perPage:g,total:e.length}}},Ae=async n=>{await E(1e3),B.unshift(n)},Ie=async n=>{await E(1e3);const r=B.findIndex(f=>f.id===n.id);B[r]=n},Re=async n=>{await E(1e3),B.splice(B.findIndex(r=>r.id===n.id),1)},Me=()=>k({page:1,perPage:10,total:0}),Se=()=>k({sortBy:"fullname",sortingOrder:null}),je=()=>k({isActive:!0,search:""}),Fe=n=>{const r=k(!1),f=k([]),{filters:i=je(),sorting:u=Se(),pagination:e=Me()}=n||{},v=async()=>{r.value=!0;const{data:o,pagination:_}=await Be({...m(i),...m(u),...m(e)});f.value=o,g(()=>{e.value=_}),r.value=!1},{ignoreUpdates:g}=ee([e,u],v,{deep:!0});return P(i,()=>{e.value.page=1,v()},{deep:!0}),v(),{isLoading:r,filters:i,sorting:u,pagination:e,therapists:f,fetch:v,async add(o){r.value=!0,await Ae(o),await v(),r.value=!1},async update(o){r.value=!0,await Ie(o),await v(),r.value=!1},async remove(o){r.value=!0,await Re(o),await v(),r.value=!1}}},Le=d("h1",{class:"page-title"},"龍筋技師",-1),ze={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},Pe={class:"flex flex-col md:flex-row gap-2 justify-start"},De={class:"va-h5"},Xe=R({__name:"TherapistsPage",setup(n){const r=k(!1),{therapists:f,isLoading:i,filters:u,sorting:e,pagination:v,...g}=Fe(),o=k(null),_=l=>{o.value=l,r.value=!0},T=()=>{o.value=null,r.value=!0},{init:c}=ne(),y=async l=>{o.value?(await g.update(l),c({message:`${l.fullname} has been updated`,color:"success"})):(g.add(l),c({message:`${l.fullname} has been created`,color:"success"}))},U=async l=>{await g.remove(l),c({message:`${l.fullname} has been deleted`,color:"success"})},h=k(),{confirm:t}=J(),x=async l=>{h.value.isFormHasUnsavedChanges?await t({maxWidth:"380px",message:"Form has unsaved changes. Are you sure you want to close it?",size:"small"})&&l():l()};return(l,p)=>{const M=b("VaButtonToggle"),A=b("VaIcon"),S=b("VaInput"),j=b("VaButton"),s=b("VaCardContent"),I=b("VaCard"),Y=b("VaModal");return N(),O(D,null,[Le,a(I,null,{default:w(()=>[a(s,null,{default:w(()=>[d("div",ze,[d("div",Pe,[a(M,{modelValue:m(u).isActive,"onUpdate:modelValue":p[0]||(p[0]=V=>m(u).isActive=V),color:"background-element","border-color":"background-element",options:[{label:"Active",value:!0},{label:"Inactive",value:!1}]},null,8,["modelValue"]),a(S,{modelValue:m(u).search,"onUpdate:modelValue":p[1]||(p[1]=V=>m(u).search=V),placeholder:"Search"},{prependInner:w(()=>[a(A,{name:"search",color:"secondary",size:"small"})]),_:1},8,["modelValue"])]),a(j,{onClick:T},{default:w(()=>[C("Add Therapist")]),_:1})]),a(ge,{"sort-by":m(e).sortBy,"onUpdate:sortBy":p[2]||(p[2]=V=>m(e).sortBy=V),"sorting-order":m(e).sortingOrder,"onUpdate:sortingOrder":p[3]||(p[3]=V=>m(e).sortingOrder=V),therapists:m(f),loading:m(i),pagination:m(v),onEditTherapist:_,onDeleteTherapist:U},null,8,["sort-by","sorting-order","therapists","loading","pagination"])]),_:1})]),_:1}),a(Y,{modelValue:r.value,"onUpdate:modelValue":p[4]||(p[4]=V=>r.value=V),size:"small","mobile-fullscreen":"","close-button":"","hide-default-actions":"","before-cancel":x},{default:w(({cancel:V,ok:X})=>[d("h1",De,$(o.value?"Edit therapist":"Add therapist"),1),a($e,{ref_key:"editFormRef",ref:h,therapist:o.value,"save-button-label":o.value?"Save":"Add",onClose:V,onSave:G=>{y(G),X()}},null,8,["therapist","save-button-label","onClose","onSave"])]),_:1},8,["modelValue"])],64)}}});export{Xe as default};
//# sourceMappingURL=TherapistsPage-d72c8be1.js.map
